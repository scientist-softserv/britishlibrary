<%# OVERRIDE Hyrax 2.9.5 to change layout of collections page for BL layout %>

<% provide :page_title, construct_page_title(@presenter.title) %>
<div class="hyc-container" itemscope itemtype="http://schema.org/CollectionPage">
  <div class="row hyc-header">
    <div class="col-md-12">

      <% unless @presenter.banner_file.blank? %>
          <header class="hyc-banner" style="background-image:url(<%= @presenter.banner_file %>)">
      <% else %>
          <header class="hyc-generic">
      <% end %>
      <% unless @presenter.total_viewable_items.blank? %>
          <div class="hyc-bugs">
            <% unless @presenter.logo_record.blank? %>
              <% unless @presenter.banner_file.blank? %>
                <div class="hyc-logos">
                  <% @presenter.logo_record.each_with_index  do |lr, i| %>
                      <% if lr[:linkurl].blank? %>
                          <img alt="<%= lr[:alttext] %>" src="<%= lr[:file_location] %>" />
                      <% else %>
                          <a href="<%= lr[:linkurl] %>">
                            <img alt="<%= lr[:alttext] %>" src="<%= lr[:file_location] %>" />
                          </a>
                      <% end %>
                  <% end %>
                </div>
              <% end %>
            <% end %>
            <div class="hyc-item-count">
              <b><%= @presenter.total_viewable_items %></b>
              <%= 'Item'.pluralize(@presenter.total_viewable_items) %>
            </div>
            <div class="hyc-badges">
              <%= @presenter.collection_type_badge %>
              <%= @presenter.permission_badge %>
            </div>
            <% unless @presenter.creator.blank? %>
                <div class="hyc-created-by">Created by: <%= @presenter.creator.first %></div>
            <% end %>
            <% unless @presenter.modified_date.blank? %>
                <div class="hyc-last-updated">Last Updated: <%= @presenter.modified_date %></div>
            <% end %>
          </div>
      <% end %>
      </header>
      <% if @presenter.banner_file.blank? %>
        <% unless @presenter.logo_record.blank? %>
          <div class="hyc-logos-no-banner">
            <% @presenter.logo_record.each_with_index  do |lr, i| %>
                <% if lr[:linkurl].blank? %>
                    <img alt="<%= lr[:alttext] %>" src="<%= lr[:file_location] %>" />
                <% else %>
                    <a href="<%= lr[:linkurl] %>">
                      <img alt="<%= lr[:alttext] %>" src="<%= lr[:file_location] %>" />
                    </a>
                <% end %>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="row hyc-body">
  <% if @presenter.banner_file %>
    <div class="col-md-7 hyc-description pt-20">
  <% else %>
    <div class="col-md-7 hyc-description">
  <% end %>
      <div>
        <h1 class="mt-0"><%= @presenter.title.first %></h1>
      </div>
      <div class="pt-20">
        <%= render 'collection_description', presenter: @presenter %>
      </div>
      <% if @presenter.collection_type_is_nestable? && @presenter.total_parent_collections > 0 %>
        <div class="hyc-blacklight hyc-bl-title">
          <h2>
            <%= t('.parent_collection_header') %> (<%= @presenter.total_parent_collections %>)
          </h2>
        </div>
        <div class="hyc-blacklight hyc-bl-results">
          <%= render 'show_parent_collections', presenter: @presenter %>
        </div>
      <% end %>

    </div>
    <% if @presenter.banner_file %>
    <div class="col-md-4 col-md-offset-1 pt-20">
    <% else %>
    <div class="col-md-4 col-md-offset-1">
    <% end %>
      <% unless has_collection_search_parameters? %>
        <div class="hyc-metadata">
          <h3 class="mt-0"><%= t('hyrax.dashboard.collections.show.metadata_header') %></h3>
          <%= render 'show_descriptions' %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Search results label -->
  <% if @members_count > 0 || @presenter.subcollection_count > 0 %>
    <div class="hyc-blacklight hyc-bl-title">
      <h2>
        <% if has_collection_search_parameters? %>
            <%= t('hyrax.dashboard.collections.show.search_results') %>
        <% end %>
      </h2>
    </div>
  <% end %>

  <!-- Search bar -->
  <div class="hyc-bl-search hyc-body row">
    <div class="col-sm-7">
      <%= render 'search_form', presenter: @presenter, url: hyrax.collection_path(@presenter.id) %>
    </div>
  </div>

  <!-- Subcollections -->
  <% if @presenter.collection_type_is_nestable? && @subcollection_count > 0 %>
      <div class="hyc-blacklight hyc-bl-title">
        <h4><%= t('.subcollection_count') %> (<%= @subcollection_count %>)</h4>
      </div>
      <div class="hyc-blacklight hyc-bl-results">
        <%= render 'subcollection_list', collection: @subcollection_docs %>
      </div>
  <% end %>

  <!-- Works -->
  <% if @members_count > 0 %>
      <div class="hyc-blacklight hyc-bl-title">
        <h4><%= t('.works_in_collection') %> (<%= @members_count %>)</h4>
      </div>

      <div class="hyc-blacklight hyc-bl-sort">
        <%= render 'sort_and_per_page', collection: @presenter %>
      </div>

      <div class="hyc-blacklight hyc-bl-results">
        <%= render_document_index @member_docs %>
      </div>

      <div class="hyc-blacklight hyc-bl-pager">
        <%= render 'paginate' %>
      </div>
  <% end # if @members_count > 0 %>
</div>